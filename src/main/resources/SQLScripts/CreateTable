CREATE TABLE Bill
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    balance BIGINT,
    user_id BIGINT NOT NULL
);

CREATE TABLE User
(
    id       BIGINT       NOT NULL AUTO_INCREMENT PRIMARY KEY,
    login    VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    role     VARCHAR(255) NOT NULL DEFAULT 'User'
);

CREATE TABLE Card
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    bill_id BIGINT NOT NULL
);

CREATE TABLE CardTicket
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    bill_id BIGINT NOT NULL
);

CREATE TABLE Replenishment
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    sum     BIGINT NOT NULL,
    bill_id BIGINT NOT NULL
);

CREATE TABLE Partner
(
    id           BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    name         VARCHAR(255),
    partner_bill BIGINT
);

CREATE TABLE Operation
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    source  BIGINT NOT NULL,
    target  BIGINT NOT NULL,
    sum     BIGINT NOT NULL,
    user_id BIGINT NOT NULL
);

CREATE TABLE OperationTicket
(
    id      BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    source  BIGINT NOT NULL,
    target  BIGINT NOT NULL,
    sum     BIGINT NOT NULL,
    user_id BIGINT NOT NULL
);

ALTER TABLE Bill
    ADD FOREIGN KEY (user_id) REFERENCES User (id);
ALTER TABLE Card
    ADD FOREIGN KEY (bill_id) REFERENCES Bill (id);
ALTER TABLE CardTicket
    ADD FOREIGN KEY (bill_id) REFERENCES Bill (id);
ALTER TABLE Replenishment
    ADD FOREIGN KEY (bill_id) REFERENCES Bill (id);
ALTER TABLE Operation
    ADD FOREIGN KEY (source) REFERENCES Bill (id);
ALTER TABLE Operation
    ADD FOREIGN KEY (target) REFERENCES Partner (id);
ALTER TABLE Operation
    ADD FOREIGN KEY (user_id) REFERENCES User (id);
ALTER TABLE OperationTicket
    ADD FOREIGN KEY (source) REFERENCES Bill (id);
ALTER TABLE OperationTicket
    ADD FOREIGN KEY (target) REFERENCES Partner (id);
ALTER TABLE OperationTicket
    ADD FOREIGN KEY (user_id) REFERENCES User (id);
